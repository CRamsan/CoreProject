plugins {
  id "com.microsoft.azure.azurefunctions" version "$globalAzureFunctionGradlePlugin"
  id "org.jetbrains.kotlin.jvm"
}

group = 'com.cramsan.petproject.azurefunction'
version = '0.0.1-SNAPSHOT'
sourceCompatibility = globalJavaCompatibility
targetCompatibility = globalJavaCompatibility

repositories {
    jcenter()
}

dependencies {
    implementation project(":petproject:appcore")
    implementation project(":framework")

    implementation "org.jetbrains.kotlin:kotlin-stdlib-jdk8:$globalKotlinVersion"
    implementation "com.microsoft.azure.functions:azure-functions-java-library:$globalAzureFunctionsJavaLibrary"
    implementation "com.google.code.gson:gson:$globalGsonVerion"
    implementation "com.fasterxml.jackson.core:jackson-databind:2.11.0"

    testImplementation "io.mockk:mockk:$globalMockkVersion"
    testImplementation "junit:junit:$globalJUnitVersion"
}

tasks.withType(org.jetbrains.kotlin.gradle.tasks.KotlinCompile).all {
    kotlinOptions {
        freeCompilerArgs = ["-Xjsr305=strict"]
        jvmTarget = globalJavaCompatibility
    }
}

test {
    testLogging {
        events "passed", "skipped", "failed"
    }
}

azurefunctions {
    resourceGroup = 'PetProject'
    appName = 'petproject-api'
    pricingTier = 'Consumption'
    region = 'centralus'
    runtime {
      os = 'windows'
    }    
    localDebug = "transport=dt_socket,server=y,suspend=n,address=5005"
}

build.finalizedBy ktlint